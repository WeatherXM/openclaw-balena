version: "2.4"

services:
  openclaw:
    build: ./gateway
    ports:
    - "80:80"
    restart: unless-stopped
    network_mode: host
    volumes:
      - openclaw_state:/data/openclaw
      - openclaw_home:/root/.openclaw
    environment:
      # Where OpenClaw will find its config:
      - OPENCLAW_CONFIG_PATH=/data/openclaw/openclaw.json

      # Auto-generated if empty (see start.sh), but users can set via Device Variables:
      - OPENCLAW_GATEWAY_TOKEN=

      # OpenClaw gateway listen settings (keep stable for balena)
      - OPENCLAW_GATEWAY_PORT=80
      - OPENCLAW_GATEWAY_HOST=0.0.0.0

      # Model provider API keys (set via balena Device Variables)
      # OpenClaw will automatically use whichever key is set
      - GOOGLE_API_KEY=${GOOGLE_API_KEY:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY:-}

volumes:
  openclaw_state:
  openclaw_home:
